zabbix_export:
  version: '6.4'
  template_groups:
    -
      uuid: 36bff6c29af64692839d077febfc7079
      name: 'Templates/Network devices'
  templates:
    -
      uuid: d1b51cd9e20c4eda98853d37ce9c50ff
      template: 'EdgeMAX SNMPv2'
      name: 'EdgeMAX SNMPv2'
      templates:
        -
          name: 'Network Generic Device by SNMP'
      groups:
        -
          name: 'Templates/Network devices'
      items:
        -
          uuid: 1158717117454ede831f4fbcfe989f88
          name: 'Load average last 1 minute'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2021.10.1.3.1
          key: LoadMinute
          history: 1d
          trends: '0'
          value_type: CHAR
          tags:
            -
              tag: Application
              value: 'System Info'
        -
          uuid: c69258ac3fd64beaa060e0ac7c4a9196
          name: 'Total amount of available memory'
          type: SNMP_AGENT
          snmp_oid: 'UCD-SNMP-MIB::memAvailReal.0'
          key: MemAvailable
          history: 7d
          trends: '0'
          units: b
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1000'
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: 865a6c6b04b941018b99913749340b69
          name: 'Total amount of buffers'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2021.4.14.0
          key: MemBuffers
          history: 7d
          trends: '0'
          units: b
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1000'
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: 4060f6a4959f41a297179319dc643d7c
          name: 'Total amount of cached'
          type: SNMP_AGENT
          snmp_oid: 1.3.6.1.4.1.2021.4.15.0
          key: MemCached
          history: 7d
          trends: '0'
          units: b
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1000'
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: da6ddfdfc2f349f683dc8b8b21f2f162
          name: 'Total amount of memory'
          type: SNMP_AGENT
          snmp_oid: 'UCD-SNMP-MIB::memTotalReal.0'
          key: MemTotal
          history: 7d
          trends: '0'
          units: b
          preprocessing:
            -
              type: MULTIPLIER
              parameters:
                - '1000'
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: 666203988c42445da5cbdd07890d5fd1
          name: 'Used memory'
          type: CALCULATED
          key: MemUsed
          history: 7d
          trends: '0'
          units: B
          params: last(//MemTotal)-last(//MemAvailable)
          tags:
            -
              tag: Application
              value: Memory
        -
          uuid: 79c979159b1d4039bb376bc68a8212a9
          name: 'Memory utizilation'
          type: CALCULATED
          key: MemUtil
          history: 7d
          trends: '0'
          value_type: FLOAT
          units: '%'
          params: '(last(//MemUsed)-last(//MemBuffers)-last(//MemCached))/last(//MemTotal)*100'
          preprocessing:
            -
              type: JAVASCRIPT
              parameters:
                - 'return Math.floor(value)'
          tags:
            -
              tag: Application
              value: Memory
          triggers:
            -
              uuid: 46414cfd19a84e428582fab29dd16a5e
              expression: 'min(/EdgeMAX SNMPv2/MemUtil,5m)>{$MEMORY.UTIL.MAX}'
              recovery_mode: RECOVERY_EXPRESSION
              recovery_expression: 'max(/EdgeMAX SNMPv2/MemUtil,5m)<{$MEMORY.UTIL.MAX}'
              name: 'High memory utilization ( >{$MEMORY.UTIL.MAX}% for 5m)'
              opdata: 'Memory utilization: {ITEM.LASTVALUE1}'
              priority: WARNING
              description: 'The system is running out of free memory.'
        -
          uuid: 274c8e9fd52c4c388b5b31fbad3f97af
          name: 'Total amount of CPUs'
          type: SNMP_AGENT
          snmp_oid: 'UCD-SNMP-MIB::ssCpuNumCpus.0'
          key: NumCPUs
          history: 7d
          trends: '0'
          tags:
            -
              tag: Application
              value: CPU
      discovery_rules:
        -
          uuid: fb38f5b8587d4c819e0ac534d6261871
          name: 'Network interfaces discovery'
          type: SNMP_AGENT
          snmp_oid: 'discovery[{#IFOPERSTATUS},1.3.6.1.2.1.2.2.1.8,{#IFNAME},1.3.6.1.2.1.31.1.1.1.1]'
          key: NetworkInterface
          delay: 1d
          item_prototypes:
            -
              uuid: 609202a3da944303b3da4b8f708aab20
              name: 'Interface {#IFNAME} : Bits received'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.6.{#SNMPINDEX}'
              key: 'net.if.in[ifHCInOctets.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              units: bps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: Application
                  value: Network
            -
              uuid: a0c2bcf229684659af818ae9d1c2b45b
              name: 'Interface {#IFNAME} : Bits sent'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.31.1.1.1.10.{#SNMPINDEX}'
              key: 'net.if.out[ifHCOutOctets.{#SNMPINDEX}]'
              history: 7d
              trends: '0'
              units: bps
              preprocessing:
                -
                  type: CHANGE_PER_SECOND
                  parameters:
                    - ''
                -
                  type: MULTIPLIER
                  parameters:
                    - '8'
              tags:
                -
                  tag: Application
                  value: Network
            -
              uuid: b9dc77b18a59401c98beab690cb184b3
              name: 'Interface {#IFNAME} : Speed'
              type: SNMP_AGENT
              snmp_oid: '1.3.6.1.2.1.2.2.1.5.{#SNMPINDEX}'
              key: 'net.if.speed[ifHighSpeed.{#SNMPINDEX}]'
              delay: 10m
              history: 1d
              trends: '0'
              units: bps
              preprocessing:
                -
                  type: DISCARD_UNCHANGED_HEARTBEAT
                  parameters:
                    - 1h
              tags:
                -
                  tag: Application
                  value: Network
      macros:
        -
          macro: '{$LOAD_AVG_PER_CPU.MAX.WARN}'
          value: '1.5'
          description: 'This macro is used as a threshold in CPU utilization trigger.'
        -
          macro: '{$MEMORY.UTIL.MAX}'
          value: '90'
          description: 'This macro is used as a threshold in memory utilization trigger.'
  triggers:
    -
      uuid: b27227eb75bb4c51964d9e28da8d07b6
      expression: 'last(/EdgeMAX SNMPv2/LoadMinute)>({$LOAD_AVG_PER_CPU.MAX.WARN}*last(/EdgeMAX SNMPv2/NumCPUs))'
      recovery_mode: RECOVERY_EXPRESSION
      recovery_expression: 'last(/EdgeMAX SNMPv2/LoadMinute)<({$LOAD_AVG_PER_CPU.MAX.WARN}*last(/EdgeMAX SNMPv2/NumCPUs))'
      name: 'Load average is too high (per CPU load over {$LOAD_AVG_PER_CPU.MAX.WARN} for 1m)'
      opdata: 'Load averages(1m): {ITEM.LASTVALUE1} for last(/EdgeMAX SNMPv2/NumCPUs) CPUs'
      priority: AVERAGE
      description: 'Per CPU load average is too high. Your system may be slow to respond.'
